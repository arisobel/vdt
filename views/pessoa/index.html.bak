{{extend 'layout.html'}}
<h3>Pessoa</h3>
{{=form.custom.begin}}
                 <div class="row">
                    <div class="col-md-8">
                        <div class="row">
                            <div class="col-md-3">
                                <label >{{=db.auth_user.first_name.label}}</label>
                                {{=form.custom.widget.first_name}}
                            </div>
                            <div class="col-md-3">
                                <label >{{=db.auth_user.last_name.label}}</label>
                                {{=form.custom.widget.last_name}}
                            </div>
                            <div class="col-md-3">
                                <label >{{=db.auth_user.username.label}}</label>
                                {{=form.custom.widget.username}}
                            </div>
                            <div class="col-md-3">
                                <label >{{=db.auth_user.nome.label}}</label>
                                {{=form.custom.widget.nome}}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <label >{{=db.auth_user.email.label}}</label>
                                {{=form.custom.widget.email}}
                            </div>

                            <div class="col-md-4">
                                <label >{{=db.auth_user.password.label}}</label>
                                {{=form.custom.widget.password}}
                            </div>

                            <div class="col-md-4">
                                <label >{{=db.auth_user.funcao.label}}</label>
                                {{=form.custom.widget.funcao}}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="row">
                            <div class="col-md-12">
                                <label >{{=db.auth_user.aulas.label}}</label>
                                {{=form.custom.widget.aulas}}
                            </div>
                        </div>
                   </div>
                </div>
{{=form.custom.submit}}
{{=form.custom.end}}
{{#=presenca_mes}}
{{# =dic_presenca}}

<div class="row">
    <div class="col-md-12">
		<div class="row">
			<div class="col-md-2">
				<select id="ano" class="form-control">
				{{ for ano in anos:}}
					{{ if ano == year: }}
					<option selected>{{=ano}}</option>
					{{ else:}}
					<option>{{=ano}}</option>
					{{ pass }}
				{{ pass }}
				</select>
			</div>
			<div class="col-md-8">
		   {{ clas_btn = "btn-outline-info" }}
		   {{ for i in range(1,13):}}
				{{ if i == month:}}
					{{ clas_btn = "btn-info" }}
					{{mes_sel="s"}}
				{{ else: }}
					{{ clas_btn = "btn-outline-info" }}
					{{mes_sel="n"}}
				{{ pass }}
				<span class="{{='btn mes {}'.format(clas_btn)}}" selecionado="{{=mes_sel}}" data-mes="{{=i}}">{{=os_meses.get(i,"-")}}</span>
			{{ pass }}
			</div>
		</div>
      
        <div id="tbl_claend">
            {{=LOAD('pessoa','calend', args=[id_pess,year, month], target='tbl_calend') }}
        </div>        
     </div>
</div>

<script>
    $(".mes").on("click", function(){

        var mes = $(this).attr("data-mes");
        $(".mes").removeClass("btn-info").addClass("btn-outline-info");
        $( ".mes" ).each(function( index ) {
          $( this ).attr('selecionado',"n");

          });
        $(this).removeClass("btn-outline-info").addClass("btn-info");
        $(this).attr('selecionado',"s");
        carrega_calend(mes);
      })

    $("#ano").on("change", function(){
        var mes = "";

        $( ".mes" ).each(function( index ) {
          var tem_sel =  $( this ).attr('selecionado');
          if(tem_sel=='s'){
              mes = $(this).attr('data-mes');
          }
          });

        carrega_calend(mes);
      })

   function carrega_calend(mes){
        var id_pes = "{{=id_pess}}"
        var ano = $("#ano").val();
       $("#tbl_calend").html("Carregando...");
       // alert("O mes Ã© " + mes + ", id_pess " + id_pes + ", ano " + ano);
       web2py_component("/noam/pessoa/calend/"+id_pes+"/"+ano+"/"+mes, 'tbl_calend');
   }

</script>
